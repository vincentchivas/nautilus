<!DOCTYPE html>
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="UTF-8">
<title>手机酷站</title>
<meta name="format-detection" content="telephone=no">
<meta http-equiv="Cache-Control" content="no-transform"> 
<meta name="viewport" content="initial-scale=1.0,maximum-scale=1.0,minimum-scale=1.0">
<link rel="stylesheet" type="text/css" href="sitenav.css"/>
<style>
#navlist {clear:both;padding:20px 10px;background-color:#f6f6f6;font-size:17px;}
.linkwrap{line-height:17px;overflow:hidden;}
.linkwrap a{display:inline-block;width:96%;text-decoration:none;text-align:left;color:#000;margin 0 7px;padding:0 0 20px 15px;}
#errload {position:absolute;text-align:center;width:100%;}
</style>
</head>

<body>
<div id="navdiv">
	<div id="bgnavlogo"></div>
	<a href="dolphin://sites" id="logo">免费小说</a>
	<span id="primaryName">总排行</span>
</div>
<div id="navlist"></div>
<div id="loading"></div>
<script type="text/javascript" src="sitenav.js"></script>
<script type="text/javascript">
function Rank()
{
	this.init();
};
Rank.prototype = {
	lastTouch:{},
	pageName:"总排行",
	lastTarget:null,
	navlist:null,
	init:function()
	{
		var tempThis = this;
		this.navlist = document.getElementById("navlist");
		this.back = document.getElementById("bgnavlogo");
		store.getListData(this.pageName,this.createList,this.showErr);
		//var a = eval(store.fakedata);
		//this.createList(a);
		store.addEvent(this.navlist,"click", function(e){
			if(e.target.className == "linkwrap" || e.target.parentNode.className == "linkwrap")
			{
				var p = e.target;
				p.style["color"] = "#0c7b00";
				if(p.className == "linkwrap")
				{
					p = p.firstChild;
				}
				var order = p.getAttribute("order");
				store.track("click","navItem",p.getAttribute("order")+"_"+p.innerText,"rankCat","novel_总排行");
			}
			e.stopPropagation();
		},false);
		store.addEvent(this.navlist,"touchstart", function(e){
			tempThis.lastTarget = e.target;
			tempThis.lastTouch = e.touches[0];
			tempThis.handleTouchStart(e);
		},false);
		store.addEvent(this.navlist,"touchend", function(e){tempThis.handleTouchEnd(e);},false);
		store.addEvent(this.navlist,"touchmove", function(e){tempThis.handleTouchMove(e);},false);
		store.addEvent(this.back,"click", function(e){
			store.track("click","backToNav",1,"novelRank","genrank.html");
			e.stopPropagation();
		},false);

	},
	createList:function(obj)
	{
		var inner = '';
		var pageName = this.Rank.prototype.pageName;
		//var pageName = this.pageName;
		if(obj.title == pageName)
		{
			var items = obj.items;
			for(var i=0;i<items.length;i++)
			{
				inner += '<div class="linkwrap"><a href="'+items[i].url+'" order="'+items[i].order+'"/>'+items[i].title+'</a></div>';
			}
		}
		var list = document.getElementById("navlist");
		list.innerHTML = inner;
	},
	showErr:function(text)
	{
		var list = document.getElementById("navlist");
		var height = store.height-list.offsetTop,width = store.width;
		list.style["height"] = height +"px";
		list.innerHTML = "<div id='errload'>数据请求错误，请稍候重试！</div>"
		var err = list.firstChild;
		err.style["top"] = parseInt(height/2 )+"px";
		err.style["left"] = parseInt((width - err.offsetWidth)/2)+"px";
	},
	handleTouchStart:function(e)
	{
		if(e.target.className == "linkwrap" || e.target.parentNode.className == "linkwrap")
		{
			var p = e.target;
			p.style["color"] = "#0c7b00";
		}
		e.stopPropagation();
	},
	handleTouchEnd:function(e)
	{
		if(e.target.className == "linkwrap" || e.target.parentNode.className == "linkwrap")
		{
			var p = e.target;
			p.style["color"] = "#000";
			if(this.lastTarget.localName == "a")
			{
				this.lastTarget.style["color"] = "#000";
			}				
		}
		e.stopPropagation();
	},
	handleTouchMove:function(e)
	{
		var pos = e.touches[0];
		if(Math.abs(pos.pageX -this.lastTouch.pageX) >6 || Math.abs(pos.pageY -this.lastTouch.pageY >6))
		{
			if(e.target.className == "linkwrap" || e.target.parentNode.className == "linkwrap")
			{
				this.lastTarget.style["color"] = "#000";
			}
		}
		e.stopPropagation();
	}
};
	window.addEventListener("load", function(e){
		store.track("pageView","novelRank","genrank.html");
		if(navigator.userAgent.indexOf("Android 2.1") != -1)
		{
			store.createStyle("sitenav21.css","a_21");
		}
		var rank = new Rank();
	},false);

</script>
</body></html>